<launch>
  <!-- ARGS -->
  <arg name="catkin_ws" default="$(dirname)/../../../" />
  <arg name="rosbag_start_delay" default="10" />
  <arg name="rosbag_input_path" default="/data/euroc_mav/rosbags/V1_01.bag" />
  <arg name="save_path" default="$(arg catkin_ws)/estimate-kalibr.txt" />
  <arg name="config_file" default="$(find bench)/configs/orbslam3/euroc-stereo_imu.yaml" />
  <arg name="vocab_file" default="$(find bench)/vocab/ORBvoc.txt" />
  <arg name="show_gui" default="true" />

  <!-- ROSBAG PLAY -->
  <node pkg="rosbag" type="play" name="player" output="screen" required="true"
      launch-prefix="bash -c 'sleep $(arg rosbag_start_delay); $0 $@' "
      args="--clock -q --rate=0.8 $(arg rosbag_input_path)">
    <remap from="/cam0/image_raw" to="/camera/left/image_raw"/>
    <remap from="/cam1/image_raw" to="/camera/right/image_raw"/>
    <remap from="/imu0"           to="/imu"/>
  </node>

  <!-- ORBSLAM3 -->
  <node name="orbslam3" pkg="bench" type="orbslam3_stereo_inertial" output="screen" required="true">
    <param name="show_gui" value="$(arg show_gui)" />
    <param name="config_file" value="$(arg config_file)" />
    <param name="vocab_file" value="$(arg vocab_file)" />
    <param name="rectify" value="true" />
    <param name="equalize" value="false" />

    <param name="save_estimation" value="true" />
    <param name="save_path" value="$(arg save_path)" />
  </node>
</launch>
